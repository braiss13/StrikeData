@page
@model StrikeData.Pages.TeamData.PitchingModel
@{
    ViewData["Title"] = "Pitching Stats";
}

<h2 class="section-title">Pitching Stats</h2>

<!-- Botones para alternar entre vistas -->
<div class="table-selector">
    <button id="basicBtn" type="button" class="btn-stat-toggle" onclick="showTable('basic')">
        Basic
    </button>
    <button id="advancedBtn" type="button" class="btn-stat-toggle inactive" onclick="showTable('advanced')">
        Advanced
    </button>
</div>

<!-- Tabla básica (MLB hasta AVG) -->
<div id="basicTable">
    <table class="table table-striped table-bordered table-sm table-with-tooltips">
        <thead>
            <tr>
                <th>#</th>
                <th>Team</th>
                <th>Games</th>
                @foreach (var statName in Model.BasicStatNames)
                {
                    var hasMeta = Model.StatMeta.TryGetValue(statName, out var meta);
                    <th>
                        <span class="stat-head">
                            <abbr title="@(hasMeta? meta!.LongName : statName)" tabindex="0">@statName</abbr>
                            @if (hasMeta && !string.IsNullOrWhiteSpace(meta!.Description))
                            {
                                <div class="stat-tooltip">
                                    <div class="stat-tooltip-title">@meta.LongName (@statName)</div>
                                    <div class="stat-tooltip-body">@meta.Description</div>
                                </div>
                            }
                        </span>
                    </th>
                }


            </tr>
        </thead>
        <tbody>
            @{
                var index_basic = 1;
                foreach (var row in Model.TeamPitchingStats)
                {
                    <tr>
                        <td>@index_basic</td>
                        <td>@row.TeamName</td>
                        <td>@row.Games</td>
                        @foreach (var statName in Model.BasicStatNames)
                        {
                            float? val;
                            row.Stats.TryGetValue(statName, out val);
                            <td>@(val.HasValue? val.Value.ToString("0.##") : "-")</td>
                        }
                    </tr>
                    index_basic++;
                }
            }
        </tbody>
    </table>
</div>

<!-- Tabla avanzada (resto de MLB + TeamRankings) -->
<div id="advancedTable" style="display:none;">
    <table class="table table-striped table-bordered table-sm pitching-table table-with-tooltips">
        <thead>
            <tr>
                <th>#</th>
                <th>Team</th>
                <th>Games</th>
                @foreach (var statName in Model.AdvancedStatNames)
                {
                    var hasMeta = Model.StatMeta.TryGetValue(statName, out var meta);
                    <th>
                        <span class="stat-head">
                            <abbr title="@(hasMeta? meta!.LongName : statName)" tabindex="0">@statName</abbr>
                            @if (hasMeta && !string.IsNullOrWhiteSpace(meta!.Description))
                            {
                                <div class="stat-tooltip">
                                    <div class="stat-tooltip-title">@meta.LongName (@statName)</div>
                                    <div class="stat-tooltip-body">@meta.Description</div>
                                </div>
                            }
                        </span>
                    </th>
                }


            </tr>
        </thead>
        <tbody>
            @{
                var index_advanced = 1;
                foreach (var row in Model.TeamPitchingStats)
                {
                    <tr>
                        <td>@index_advanced</td>
                        <td>@row.TeamName</td>
                        <td>@row.Games</td>
                        @foreach (var statName in Model.AdvancedStatNames)
                        {
                            float? val;
                            row.Stats.TryGetValue(statName, out val);
                            <td>@(val.HasValue? val.Value.ToString("0.##") : "-")</td>
                        }
                    </tr>
                    index_advanced++;
                }
            }
        </tbody>
    </table>
</div>


<script>
    // Alterna entre la tabla básica y la avanzada, y marca el botón activo/inactivo
    function showTable(type) {
        document.getElementById('basicTable').style.display = (type === 'basic') ? 'block' : 'none';
        document.getElementById('advancedTable').style.display = (type === 'advanced') ? 'block' : 'none';

        const basicBtn = document.getElementById('basicBtn');
        const advancedBtn = document.getElementById('advancedBtn');
        if (type === 'basic') {
            basicBtn.classList.remove('inactive');
            advancedBtn.classList.add('inactive');
        } else {
            basicBtn.classList.add('inactive');
            advancedBtn.classList.remove('inactive');
        }
    }

    // Mostrar la tabla básica por defecto al cargar la página
    showTable('basic');

</script>
